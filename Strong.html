<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>30 Day Fitness Quest</title>
  <style>
    body { font-family: 'Poppins', sans-serif; margin: 0; background: linear-gradient(135deg, #141E30, #243B55); color: #eee; overflow-x: hidden; }
    header { text-align: center; padding: 1rem; background: linear-gradient(to right, #00c6ff, #0072ff); color: white; box-shadow: 0 4px 10px rgba(0,0,0,0.4); position: relative; }
    .nav { position: absolute; top: 1rem; left: 1rem; font-size: 1.8rem; cursor: pointer; }
    .sidebar { height: 100%; width: 0; position: fixed; top: 0; left: 0; background: rgba(20,30,48,0.95); transition: 0.4s; overflow-x: hidden; padding-top: 60px; z-index: 100; }
    .sidebar a { display: block; padding: 12px 24px; font-size: 1.2rem; text-decoration: none; color: #ffcc00; }
    .sidebar a:hover { color: #fff; }
    .closebtn { position: absolute; top: 20px; right: 25px; font-size: 2rem; cursor: pointer; color: #ffcc00; }

    .section { display: none; padding: 1rem; }
    .active-section { display: block; }

    .profile, .reward { text-align: center; margin: 1rem auto; background: rgba(255,255,255,0.08); padding: 1rem; border-radius: 10px; box-shadow: 0 2px 12px rgba(0,0,0,0.4); max-width: 600px; }
    .day-card { background: rgba(255,255,255,0.05); margin: 1rem auto; padding: 1rem; border-radius: 12px; max-width: 500px; box-shadow: 0 2px 8px rgba(0,0,0,0.4); cursor: pointer; }
    .day-header { display: flex; justify-content: space-between; font-size: 1.2rem; font-weight: bold; color: #00eaff; }
    .tasks, .motivation { margin-top: 1rem; display: none; }
    .tasks li { list-style: none; margin: 8px 0; }

    button { background: #ffcc00; border: none; padding: 10px 16px; border-radius: 6px; font-weight: bold; cursor: pointer; margin-top: 10px; }
    button:hover { background: #ffd633; }

    .progress-bar { width: 90%; margin: 1rem auto; background: #444; border-radius: 20px; overflow: hidden; }
    .progress { height: 20px; background: linear-gradient(to right, #ffcc00, #ff8800); width: 0%; text-align: center; color: black; font-weight: bold; font-size: 12px; line-height: 20px; transition: width 0.5s; }
    /* Normal countdown */
.rewardCountdown {
  font-weight: bold;
  color: #0077cc; /* blue accent */
}

/* Highlight when it's reward day */
.rewardToday {
  color: #d4af37; /* gold */
  font-size: 1.1em;
  font-weight: bold;
  text-shadow: 0 0 6px rgba(212, 175, 55, 0.6);
}

  </style>
</head>
<body>
  <header>
    <span class="nav" onclick="openNav()">☰</span>
    <h1>💪 30 Day Fitness Quest</h1>
    <p id="welcome"></p>
  </header>

  <div id="sidebar" class="sidebar">
    <span class="closebtn" onclick="closeNav()">×</span>
    <a href="#" onclick="showSection('home')">🏠 Home</a>
    <a href="#" onclick="showSection('profile')">👤 Profile</a>
    <a href="#" onclick="showSection('rewards')">🎁 Rewards</a>
    <a href="#" onclick="showSection('settings')">⚙️ Settings</a>
  </div>

<div id="setup" class="section active-section">
  <div class="profile">
    <h2>👋 Welcome to 90 Day Fitness Quest</h2>

    <!-- Tabs -->
    <div style="margin-bottom: 1rem;">
      <button onclick="showSignup()" id="signupTab">🆕 Sign Up</button>
      <button onclick="showLogin()" id="loginTab">🔑 Log In</button>
    </div>

    <!-- Sign Up -->
    <div id="signupForm">
      <input type="text" id="signupUsername" placeholder="Choose a username"><br><br>
      <select id="goalInput">
        <option value="muscle">💪 Muscle Gain</option>
        <option value="focus">🧘 Focus & OMAD</option>
      </select><br><br>
      <button onclick="saveSetup()">Start My Journey 🚀</button>
    </div>

    <!-- Log In -->
    <div id="loginForm" style="display:none;">
      <input type="text" id="loginUsername" placeholder="Enter your username"><br><br>
      <button onclick="loginUser()">Continue ➡️</button>
    </div>

    <p id="setupMessage" style="margin-top:15px; color:#ffcc00; font-weight:bold;"></p>
  </div>
</div>


<div id="profile" class="section">
  <h2>👤 Profile</h2>
  <p><strong>Name:</strong> <span id="profileName"></span></p>
  <p><strong>Goal:</strong> <span id="profileGoal"></span></p>
  <p><strong>Current Week:</strong> <span id="profileWeek"></span></p>
  <p><strong>Total Points:</strong> <span id="profilePoints"></span></p>
  <p><strong>Next Reward:</strong> <span id="nextReward" class="rewardCountdown"></span></p>
</div>


<div id="rewards" class="section">
  <h2>🎁 Rewards Unlocked</h2>
  <ul id="rewardsList"></ul>
</div>

<div id="settings" class="section">
  <h2>⚙️ Settings</h2>
  <button onclick="resetProgress()">Reset Progress</button>
</div>

<div id="home" class="section">
  <div class="profile">
    <h2>📅 Your Fitness Plan</h2>
    <p id="todayDate"></p> <!-- today's date will appear here -->
    <button id="startBtn" onclick="startOrContinueWeek()">Start Week</button>
    <div class="progress-bar"><div id="progress" class="progress"></div></div>
    <p id="week"></p>
    <p id="points"></p>
    <p>Upcoming Reward: <span id="reward"></span></p>
<p id="daysLeft"></p>

    <!-- new weekly goal section -->
    <div id="weeklyGoal" style="margin-top:1rem; text-align:center;"></div>
  </div>
  <div id="plan"></div>
</div>


  <footer style="text-align:center; margin:1rem;">✔️ Tick daily tasks, earn points, unlock rewards 🚀</footer>

  <script>
    function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

      // 💡 Motivation messages pool
  const motivations = [
    "🔥 Stay strong, you’ve got this!",
    "💪 Small steps every day lead to big results.",
    "⚡ Push harder than yesterday!",
    "🌟 Progress, not perfection.",
    "🏆 One step closer to your best self.",
    "🔥 Sweat today, shine tomorrow.",
    "💯 Discipline beats motivation."
  ];

const weeksMuscleGain = {
  // ========= Month 1 (Foundation) =========
  1:[
    {day:"Sun",tasks:["Rest day"]},
    {day:"Mon",tasks:["Standard Push-ups 3x10","Bodyweight Squats 3x12","Plank 20s"]},
    {day:"Tue",tasks:["Jog 15 min"]},
    {day:"Wed",tasks:["Incline Push-ups 3x12","Glute Bridges 3x12","Plank 25s"]},
    {day:"Thu",tasks:["Knee Push-ups 3x12","Lunges 3x10 each leg","Side Plank 20s each side"]},
    {day:"Fri",tasks:["Jog 15 min","Mountain Climbers 3x15"]},
    {day:"Sat",tasks:["🎁 Reward Day: Swimming / Music"]}
  ],
  2:[
    {day:"Sun",tasks:["Rest day"]},
    {day:"Mon",tasks:["Standard Push-ups 3x12","Jump Squats 3x10","Plank 30s"]},
    {day:"Tue",tasks:["Jog 18 min"]},
    {day:"Wed",tasks:["Incline Push-ups 4x10","Glute Bridges 3x15","Plank 30s"]},
    {day:"Thu",tasks:["Diamond Push-ups 3x8","Reverse Lunges 3x12 each leg","Side Plank 25s each side"]},
    {day:"Fri",tasks:["Jog 18 min","Mountain Climbers 3x20"]},
    {day:"Sat",tasks:["🎁 Reward Day: Hiking / Music"]}
  ],
  3:[
    {day:"Sun",tasks:["Rest day"]},
    {day:"Mon",tasks:["Wide Push-ups 3x12","Bulgarian Split Squats 3x10 each leg","Plank 35s"]},
    {day:"Tue",tasks:["Jog 20 min"]},
    {day:"Wed",tasks:["Incline Push-ups 4x12","Hip Thrusts 3x12","Leg Raises 3x10"]},
    {day:"Thu",tasks:["Diamond Push-ups 3x10","Step-ups 3x12 each leg","Side Plank 30s each side"]},
    {day:"Fri",tasks:["Jog 20 min","Burpees 3x8"]},
    {day:"Sat",tasks:["🎁 Reward Day: Outdoor Activity"]}
  ],
  4:[
    {day:"Sun",tasks:["Rest day"]},
    {day:"Mon",tasks:["Decline Push-ups 3x10","Jump Squats 3x12","Plank 40s"]},
    {day:"Tue",tasks:["Jog 22 min"]},
    {day:"Wed",tasks:["Archer Push-ups 3x8","Glute Bridges 4x12","Leg Raises 3x12"]},
    {day:"Thu",tasks:["Diamond Push-ups 4x8","Lunges 4x12 each leg","Side Plank 35s each side"]},
    {day:"Fri",tasks:["Jog 22 min","Burpees 3x10"]},
    {day:"Sat",tasks:["🎁 Reward Day: Movie Night"]}
  ],

  // ========= Month 2 (Strength & Endurance) =========
  5:[
    {day:"Sun",tasks:["Rest day"]},
    {day:"Mon",tasks:["Standard Push-ups 4x12","Bulgarian Split Squats 3x12 each leg","Plank 45s"]},
    {day:"Tue",tasks:["Jog 25 min"]},
    {day:"Wed",tasks:["Incline Push-ups 4x12","Hip Thrusts 4x12","Leg Raises 3x15"]},
    {day:"Thu",tasks:["Decline Push-ups 3x10","Jump Lunges 3x10 each leg","Side Plank 40s each side"]},
    {day:"Fri",tasks:["Jog 25 min","Burpees 3x12"]},
    {day:"Sat",tasks:["🎁 Reward Day: Nyama Choma"]}
  ],
  6:[
    {day:"Sun",tasks:["Rest day"]},
    {day:"Mon",tasks:["Wide Push-ups 4x12","Pistol Squat (assisted) 3x6 each leg","Plank 50s"]},
    {day:"Tue",tasks:["Jog 28 min"]},
    {day:"Wed",tasks:["Diamond Push-ups 4x10","Glute Bridges 4x15","Leg Raises 4x10"]},
    {day:"Thu",tasks:["Decline Push-ups 4x10","Step-ups 4x12 each leg","Side Plank 45s each side"]},
    {day:"Fri",tasks:["Jog 28 min","Burpees 3x15"]},
    {day:"Sat",tasks:["🎁 Reward Day: Music / Game Night"]}
  ],
  7:[
    {day:"Sun",tasks:["Rest day"]},
    {day:"Mon",tasks:["Archer Push-ups 4x8","Jump Squats 4x12","Plank 55s"]},
    {day:"Tue",tasks:["Jog 30 min"]},
    {day:"Wed",tasks:["Incline Push-ups 5x10","Hip Thrusts 4x15","Leg Raises 4x12"]},
    {day:"Thu",tasks:["Diamond Push-ups 4x12","Walking Lunges 3x14 each leg","Side Plank 50s each side"]},
    {day:"Fri",tasks:["Jog 30 min","Burpees 4x10"]},
    {day:"Sat",tasks:["🎁 Reward Day: Outdoor Fun"]}
  ],
  8:[
    {day:"Sun",tasks:["Rest day"]},
    {day:"Mon",tasks:["Decline Push-ups 4x12","Bulgarian Split Squats 4x12 each leg","Plank 60s"]},
    {day:"Tue",tasks:["Jog 32 min"]},
    {day:"Wed",tasks:["Archer Push-ups 4x10","Glute Bridges 4x18","Leg Raises 4x15"]},
    {day:"Thu",tasks:["Diamond Push-ups 5x10","Jump Lunges 4x12 each leg","Side Plank 55s each side"]},
    {day:"Fri",tasks:["Jog 32 min","Burpees 4x12"]},
    {day:"Sat",tasks:["🎁 Reward Day: Music / Nyama Choma"]}
  ],

  // ========= Month 3 (Peak Challenge) =========
  9:[
    {day:"Sun",tasks:["Rest day"]},
    {day:"Mon",tasks:["Standard Push-ups 5x12","Jump Squats 4x15","Plank 65s"]},
    {day:"Tue",tasks:["Jog 35 min"]},
    {day:"Wed",tasks:["Incline Push-ups 5x12","Hip Thrusts 5x12","Leg Raises 4x18"]},
    {day:"Thu",tasks:["Diamond Push-ups 5x12","Walking Lunges 4x14 each leg","Side Plank 60s each side"]},
    {day:"Fri",tasks:["Jog 35 min","Burpees 4x15"]},
    {day:"Sat",tasks:["🎁 Reward Day: Party"]}
  ],
  10:[
    {day:"Sun",tasks:["Rest day"]},
    {day:"Mon",tasks:["Wide Push-ups 5x12","Pistol Squat (assisted) 4x8 each leg","Plank 70s"]},
    {day:"Tue",tasks:["Jog 38 min"]},
    {day:"Wed",tasks:["Decline Push-ups 5x10","Glute Bridges 5x15","Leg Raises 5x12"]},
    {day:"Thu",tasks:["Archer Push-ups 4x12","Jump Squats 4x15","Side Plank 65s each side"]},
    {day:"Fri",tasks:["Jog 38 min","Burpees 5x10"]},
    {day:"Sat",tasks:["🎁 Reward Day: Movie Night"]}
  ],
  11:[
    {day:"Sun",tasks:["Rest day"]},
    {day:"Mon",tasks:["Diamond Push-ups 5x12","Bulgarian Split Squats 4x14 each leg","Plank 75s"]},
    {day:"Tue",tasks:["Jog 40 min"]},
    {day:"Wed",tasks:["Decline Push-ups 5x12","Hip Thrusts 5x18","Leg Raises 5x15"]},
    {day:"Thu",tasks:["Archer Push-ups 5x10","Walking Lunges 4x16 each leg","Side Plank 70s each side"]},
    {day:"Fri",tasks:["Jog 40 min","Burpees 5x12"]},
    {day:"Sat",tasks:["🎁 Reward Day: Nyama Choma"]}
  ],
  12:[
    {day:"Sun",tasks:["Rest day"]},
    {day:"Mon",tasks:["Mixed Push-up Circuit (Standard, Wide, Diamond) 5x10 each","Jump Squats 5x15","Plank 80s"]},
    {day:"Tue",tasks:["Jog 45 min"]},
    {day:"Wed",tasks:["Archer Push-ups 5x12","Glute Bridges 5x20","Leg Raises 5x18"]},
    {day:"Thu",tasks:["Decline Push-ups 5x12","Pistol Squat (assisted) 4x10 each leg","Side Plank 75s each side"]},
    {day:"Fri",tasks:["Jog 45 min","Burpees 5x15"]},
    {day:"Sat",tasks:["🎁 Reward Day: Celebration 🎉"]}
  ]
};


const weeksFocusOMAD = {
  1:[ 
     {day:"Sun",tasks:["Rest day"]},
     {day:"Mon",tasks:["Push-ups 3x8–12","Squats 3x10–12","Plank 20–30s"]},
     {day:"Tue",tasks:["Walk 15 min","Mobility 10 min"]},
     {day:"Wed",tasks:["Lunges 3x10 each leg","Squats 3x10","Side Plank 2x20s each side"]},
     {day:"Thu",tasks:["Push-ups 4x8–10","Dips 3x8–10","Plank w/ shoulder taps 2x10 each side"]},
     {day:"Fri",tasks:["Walk / cycle 15 min","Leg raises 3x10","Bird-dogs 3x12"]},
     {day:"Sat",tasks:["🎁 Reward Day: Swimming / Cycling / Music"]}
  ],

  2:[
     {day:"Sun",tasks:["Rest day"]},
     {day:"Mon",tasks:["Incline Push-ups 3x10","Goblet Squats 3x12","Plank 30s"]},
     {day:"Tue",tasks:["Jog 20 min","Mobility flow 10 min"]},
     {day:"Wed",tasks:["Reverse Lunges 3x12 each leg","Glute bridges 3x15","Side Plank 3x20s each side"]},
     {day:"Thu",tasks:["Diamond Push-ups 3x8","Chair Dips 3x10","Mountain Climbers 3x20"]},
     {day:"Fri",tasks:["Walk / cycle 20 min","Leg raises 3x12","Supermans 3x12"]},
     {day:"Sat",tasks:["🎁 Reward Day: Swimming / Cycling / Music"]}
  ],

  3:[
     {day:"Sun",tasks:["Rest day"]},
     {day:"Mon",tasks:["Decline Push-ups 3x10","Split Squats 3x12 each leg","Plank 40s"]},
     {day:"Tue",tasks:["Jog 25 min","Mobility flow 15 min"]},
     {day:"Wed",tasks:["Step-ups 3x12 each leg","Glute bridges 4x15","Side Plank 3x25s each side"]},
     {day:"Thu",tasks:["Wide Push-ups 3x10","Bench Dips 3x12","Mountain Climbers 4x20"]},
     {day:"Fri",tasks:["Cycle 20 min","Hollow Holds 3x20s","Bird-dogs 4x12"]},
     {day:"Sat",tasks:["🎁 Reward Day: Swimming / Cycling / Music"]}
  ],

  4:[
     {day:"Sun",tasks:["Rest day"]},
     {day:"Mon",tasks:["Archer Push-ups 3x6 each side","Bulgarian Split Squats 3x12 each leg","Plank 45s"]},
     {day:"Tue",tasks:["Jog 25 min","Yoga flow 20 min"]},
     {day:"Wed",tasks:["Jump Squats 3x12","Glute bridges 4x20","Side Plank 3x30s each side"]},
     {day:"Thu",tasks:["Decline Push-ups 3x12","Chair Dips 4x10","Mountain Climbers 4x25"]},
     {day:"Fri",tasks:["Walk 20 min","Leg Raises 3x15","Supermans 4x15"]},
     {day:"Sat",tasks:["🎁 Reward Day: Swimming / Cycling / Music"]}
  ],

  5:[
     {day:"Sun",tasks:["Rest day"]},
     {day:"Mon",tasks:["Diamond Push-ups 4x8","Step-ups 4x12 each leg","Plank 50s"]},
     {day:"Tue",tasks:["Jog 30 min","Yoga mobility 20 min"]},
     {day:"Wed",tasks:["Jump Lunges 3x10 each leg","Glute Bridges 4x20","Side Plank 4x30s each side"]},
     {day:"Thu",tasks:["Wide Push-ups 4x10","Dips 4x10","Mountain Climbers 4x30"]},
     {day:"Fri",tasks:["Cycle 25 min","Leg Raises 4x12","Bird-dogs 4x15"]},
     {day:"Sat",tasks:["🎁 Reward Day: Swimming / Cycling / Music"]}
  ],

  6:[
     {day:"Sun",tasks:["Rest day"]},
     {day:"Mon",tasks:["Pike Push-ups 3x10","Bulgarian Split Squats 4x12 each leg","Plank 60s"]},
     {day:"Tue",tasks:["Jog 30 min","Yoga flow 20 min"]},
     {day:"Wed",tasks:["Jump Squats 4x12","Hip Thrusts 3x15","Side Plank 4x35s each side"]},
     {day:"Thu",tasks:["Decline Push-ups 4x12","Chair Dips 4x12","Burpees 3x10"]},
     {day:"Fri",tasks:["Cycle 30 min","Hollow Holds 4x25s","Supermans 4x15"]},
     {day:"Sat",tasks:["🎁 Reward Day: Swimming / Cycling / Music"]}
  ],

  7:[
     {day:"Sun",tasks:["Rest day"]},
     {day:"Mon",tasks:["Spiderman Push-ups 3x8","Squat Jumps 4x12","Plank 70s"]},
     {day:"Tue",tasks:["Jog 35 min","Mobility 20 min"]},
     {day:"Wed",tasks:["Curtsy Lunges 4x12 each leg","Glute Kickbacks 4x15","Side Plank 4x40s each side"]},
     {day:"Thu",tasks:["Diamond Push-ups 4x10","Parallel Bar Dips 3x10","Mountain Climbers 5x25"]},
     {day:"Fri",tasks:["Run 25 min","Leg Raises 4x15","Bird-dogs 5x15"]},
     {day:"Sat",tasks:["🎁 Reward Day: Swimming / Cycling / Music"]}
  ],

  8:[
     {day:"Sun",tasks:["Rest day"]},
     {day:"Mon",tasks:["Wide Push-ups 4x12","Bulgarian Split Squats 4x12 each leg","Plank 80s"]},
     {day:"Tue",tasks:["Jog 35 min","Yoga mobility 20 min"]},
     {day:"Wed",tasks:["Jump Lunges 4x12 each leg","Hip Thrusts 4x20","Side Plank 4x45s each side"]},
     {day:"Thu",tasks:["Archer Push-ups 3x8 each side","Chair Dips 4x12","Burpees 4x10"]},
     {day:"Fri",tasks:["Cycle 30 min","Hollow Holds 4x30s","Supermans 5x15"]},
     {day:"Sat",tasks:["🎁 Reward Day: Swimming / Cycling / Music"]}
  ],

  9:[
     {day:"Sun",tasks:["Rest day"]},
     {day:"Mon",tasks:["Decline Push-ups 4x12","Pistol Squats (assisted) 3x6 each leg","Plank 90s"]},
     {day:"Tue",tasks:["Jog 40 min","Yoga flow 20 min"]},
     {day:"Wed",tasks:["Step-ups 4x12 each leg","Glute Kickbacks 4x20","Side Plank 4x50s each side"]},
     {day:"Thu",tasks:["Pike Push-ups 4x10","Dips 4x12","Mountain Climbers 5x30"]},
     {day:"Fri",tasks:["Run 30 min","Leg Raises 5x12","Bird-dogs 5x20"]},
     {day:"Sat",tasks:["🎁 Reward Day: Swimming / Cycling / Music"]}
  ],

  10:[
     {day:"Sun",tasks:["Rest day"]},
     {day:"Mon",tasks:["Diamond Push-ups 4x12","Jump Squats 5x12","Plank 100s"]},
     {day:"Tue",tasks:["Jog 40 min","Yoga flow 25 min"]},
     {day:"Wed",tasks:["Curtsy Lunges 5x12 each leg","Hip Thrusts 5x15","Side Plank 4x55s each side"]},
     {day:"Thu",tasks:["Archer Push-ups 4x8 each side","Chair Dips 5x10","Burpees 4x12"]},
     {day:"Fri",tasks:["Cycle 35 min","Hollow Holds 5x30s","Supermans 5x20"]},
     {day:"Sat",tasks:["🎁 Reward Day: Swimming / Cycling / Music"]}
  ],

  11:[
     {day:"Sun",tasks:["Rest day"]},
     {day:"Mon",tasks:["Pike Push-ups 4x12","Bulgarian Split Squats 5x12 each leg","Plank 110s"]},
     {day:"Tue",tasks:["Jog 45 min","Yoga flow 25 min"]},
     {day:"Wed",tasks:["Jump Lunges 5x12 each leg","Glute Kickbacks 5x20","Side Plank 5x30s each side"]},
     {day:"Thu",tasks:["Decline Push-ups 5x12","Parallel Bar Dips 4x12","Burpees 4x15"]},
     {day:"Fri",tasks:["Run 35 min","Leg Raises 5x15","Bird-dogs 5x20"]},
     {day:"Sat",tasks:["🎁 Reward Day: Swimming / Cycling / Music"]}
  ],

  12:[
     {day:"Sun",tasks:["Rest day"]},
     {day:"Mon",tasks:["Spiderman Push-ups 4x10","Pistol Squats (assisted) 4x8 each leg","Plank 120s"]},
     {day:"Tue",tasks:["Jog 45 min","Yoga flow 25 min"]},
     {day:"Wed",tasks:["Jump Squats 5x15","Hip Thrusts 5x20","Side Plank 5x35s each side"]},
     {day:"Thu",tasks:["Archer Push-ups 5x8 each side","Dips 5x12","Burpees 5x12"]},
     {day:"Fri",tasks:["Cycle 40 min","Hollow Holds 5x35s","Supermans 5x20"]},
     {day:"Sat",tasks:["🎁 Reward Day: Swimming / Cycling / Music"]}
  ]
};


  let rewards = ["Nyama choma 🍖","Swimming 🏊","Hiking 🌳","Cycling 🚴","Music 🎶"];

let player = JSON.parse(localStorage.getItem("fitness30Day")) || {
  name: "",
  goal: "",
  week: 1,
  points: 0,
  totalTasks: 0,
  dayProgress: 0,
  completed: {},
  startedWeek: false,
  rewardsAchieved: [],
  rewardsOrder: shuffle([...rewards]) // randomize rewards for this cycle
};

function saveSetup() {
  const username = document.getElementById("signupUsername").value.trim();
  const goal = document.getElementById("goalInput").value;
  const messageEl = document.getElementById("setupMessage");

  if (!username) {
    messageEl.textContent = "⚠️ Please choose a username!";
    return;
  }

  if (localStorage.getItem(`fitness30Day_${username}`)) {
    messageEl.textContent = "⚠️ Username already taken. Please log in instead.";
    return;
  }

  // Create new profile
  player = {
    name: username,
    goal: goal,
    week: 1,
    points: 0,
    totalTasks: 0,
    dayProgress: 0,
    completed: {},
    startedWeek: true,
    rewardsAchieved: [],
    rewardsOrder: shuffle([...rewards])
  };

  localStorage.setItem(`fitness30Day_${username}`, JSON.stringify(player));
  localStorage.setItem("fitness30Day_current", username);

  messageEl.textContent = `🎉 New profile created for ${player.name}. Let's go!`;

  document.getElementById("welcome").textContent = `Welcome, ${player.name}! Goal: ${player.goal}`;
  showSection("home");
  showPlan();
  updateProfile();
}
function loginUser() {
  const username = document.getElementById("loginUsername").value.trim();
  const messageEl = document.getElementById("setupMessage");

  if (!username) {
    messageEl.textContent = "⚠️ Please enter your username!";
    return;
  }

  let storedPlayer = localStorage.getItem(`fitness30Day_${username}`);
  if (!storedPlayer) {
    messageEl.textContent = "❌ No account found. Please Sign Up first.";
    return;
  }

  player = JSON.parse(storedPlayer);
  localStorage.setItem("fitness30Day_current", username);

  messageEl.textContent = `✅ Welcome back, ${player.name}!`;

  document.getElementById("welcome").textContent = `Welcome, ${player.name}! Goal: ${player.goal}`;
  showSection("home");
  showPlan();
  updateProfile();
}


function savePlayer() {
  if (player && player.name) {
    localStorage.setItem(`fitness30Day_${player.name}`, JSON.stringify(player));
    localStorage.setItem("fitness30Day_current", player.name); // track who is logged in
  }
}

function startOrContinueWeek() {
  player.startedWeek = true;
  savePlayer();
  showPlan();
  updateProfile();

  let now = new Date();
let todayIndex = now.getDay(); // Sunday=0, Saturday=6
if (now.getHours() < 5) {
  todayIndex = todayIndex - 1;
  if (todayIndex < 0) todayIndex = 6;
}


  const cards = document.querySelectorAll(".day-card");

  // ✅ Scroll to today's card
  const todayCard = cards[todayIndex];
  if (todayCard) {
    todayCard.scrollIntoView({ behavior: "smooth", block: "start" });

    // Expand today's card (tasks clickable)
    const mot = todayCard.querySelector(".motivation");
    const tasks = todayCard.querySelector(".tasks");
    mot.style.display = "block";
    tasks.style.display = "block";
  }

  // 👀 Expand tomorrow’s card (preview only, no clicks)
  const nextCard = cards[todayIndex + 1];
  if (nextCard) {
    const nextMot = nextCard.querySelector(".motivation");
    const nextTasks = nextCard.querySelector(".tasks");
    nextMot.style.display = "block";
    nextTasks.style.display = "block";

    // Disable checkboxes (make preview only)
    nextTasks.querySelectorAll("input[type='checkbox']").forEach(cb => {
      cb.disabled = true;
    });

    // Slightly dim tomorrow’s card
    nextCard.style.opacity = "0.7";
  }
}
function getCurrentPlan() {
  // Odd weeks → Muscle Gain, Even weeks → Focus Plan
  if (player.week % 2 === 1) {
    return weeksMuscleGain;
  } else {
    return weeksFocusOMAD;
  }
}

  function showPlan() {
  const container = document.getElementById("plan");
  container.innerHTML = "";
 const plan = getCurrentPlan();
const weekPlan = plan[player.week];


  player.totalTasks = 0;

  if (!player.startedWeek) {
    container.innerHTML = "<p style='text-align:center;'>Click Start Week to begin ✅</p>";
    return;
  }

  let now = new Date();
  let todayIndex = now.getDay() - 1; // Monday = 0
  if (todayIndex < 0) todayIndex = 6;
  if (now.getHours() < 5) {
    todayIndex = todayIndex - 1;
    if (todayIndex < 0) todayIndex = 6;
  }

  weekPlan.forEach((p, i) => {
    const card = document.createElement("div");
    card.className = "day-card";
    const locked = i > todayIndex;

    card.innerHTML = `
      <div class='day-header' style='${locked ? "opacity:0.5;pointer-events:none;" : ""}'>
        <span>${p.day}</span><span>▶️</span>
      </div>
<div class='motivation'>
  <p><em>"${motivations[Math.floor(Math.random() * motivations.length)]}"</em></p>
  <p style="margin-top:6px;">Tasks for ${p.day}</p>
</div>


      <ul class='tasks'>
        ${p.tasks.map((t, idx) => {
          player.totalTasks++;
          const key = `${player.week}-${i}-${idx}`;
          const checked = player.completed[key] ? "checked" : "";
          return `<li><input type='checkbox' ${checked} onchange='completeTask(${i},${idx},this)'> ${t}</li>`;
        }).join("")}
      </ul>
    `;

    card.querySelector(".day-header").addEventListener("click", () => {
      const mot = card.querySelector(".motivation");
      const tasks = card.querySelector(".tasks");
      mot.style.display = mot.style.display === "block" ? "none" : "block";
      tasks.style.display = tasks.style.display === "block" ? "none" : "block";
    });

    // ✅ Always expand today's tasks
    if (i === todayIndex) {
      card.querySelector(".motivation").style.display = "block";
      card.querySelector(".tasks").style.display = "block";

      // ✅ Check if all today's tasks are already completed
      const todaysTasks = p.tasks.length;
      let completedToday = 0;
      for (let j = 0; j < todaysTasks; j++) {
        if (player.completed[`${player.week}-${i}-${j}`]) completedToday++;
      }
      if (completedToday === todaysTasks) {
        const message = document.createElement("p");
        message.id = `congrats-${i}`;
        message.style.color = "#ffcc00";
        message.style.fontWeight = "bold";
        message.style.marginTop = "10px";
        message.textContent = `🎉 Great job! You've already finished all tasks for ${p.day}.`;
        card.appendChild(message);
      }
    }

    container.appendChild(card);
  });

  scheduleRefreshAtFive();
}


function scheduleRefreshAtFive() {
  const now = new Date();
  let next5am = new Date();
  next5am.setHours(5, 0, 0, 0);

  // If it's already past 5 AM, set for tomorrow
  if (now >= next5am) {
    next5am.setDate(next5am.getDate() + 1);
  }

  const timeUntil5 = next5am - now;
  setTimeout(() => {
    location.reload(); // refresh at 5 AM
  }, timeUntil5);
}


function completeTask(day, task, box) {
  const key = `${player.week}-${day}-${task}`;
  if (box.checked) {
    if (!player.completed[key]) {
      player.completed[key] = true;
      player.points += 10;
      player.dayProgress++;
    }
  } else {
    if (player.completed[key]) {
      delete player.completed[key];
      player.points = Math.max(0, player.points - 10);
      player.dayProgress = Math.max(0, player.dayProgress - 1);
    }
  }
  savePlayer();
  updateProfile();

const plan = getCurrentPlan();
const weekPlan = plan[player.week];


  let now = new Date();
  let todayIndex = now.getDay() - 1; // Monday = 0
  if (todayIndex < 0) todayIndex = 6;
  if (now.getHours() < 5) {
    todayIndex = todayIndex - 1;
    if (todayIndex < 0) todayIndex = 6;
  }

  const todaysTasks = weekPlan[todayIndex].tasks.length;

  let completedToday = 0;
  for (let i = 0; i < todaysTasks; i++) {
    if (player.completed[`${player.week}-${todayIndex}-${i}`]) completedToday++;
  }

  // Remove old message if it exists
  let oldMsg = document.querySelector(`#congrats-${todayIndex}`);
  if (oldMsg) oldMsg.remove();

  // ✅ Show congrats immediately after last task
  if (completedToday === todaysTasks) {
    const todayCard = document.querySelectorAll(".day-card")[todayIndex];
    const message = document.createElement("p");
    message.id = `congrats-${todayIndex}`;
    message.style.color = "#ffcc00";
    message.style.fontWeight = "bold";
    message.style.marginTop = "10px";
    message.textContent = `🎉 Great job! You've finished all tasks for ${weekPlan[todayIndex].day}. Come back tomorrow at the same time for your next challenge!`;
    todayCard.appendChild(message);
  }
}
function endWeek() {
  if (player.points === player.totalTasks * 10) {
    const now = new Date();
    let todayIndex = now.getDay(); // Sunday=0, Saturday=6
    if (now.getHours() < 5) {
      todayIndex = todayIndex - 1;
      if (todayIndex < 0) todayIndex = 6;
    }

    // ✅ Only give reward if today is Saturday
    if (todayIndex === 6) {
      const rewardIndex = (player.week - 1) % player.rewardsOrder.length;
      const earnedReward = player.rewardsOrder[rewardIndex];
      player.rewardsAchieved.push(earnedReward);

      alert(`🎉 Week ${player.week} Complete! Reward unlocked: ${earnedReward}`);
    } else {
      alert(`🎉 Week ${player.week} Complete!`);
    }

    // Move to next week
    player.week++;
    player.points = 0;
    player.dayProgress = 0;
    player.completed = {};
    player.startedWeek = true; // auto-start new week

    // Reshuffle rewards when cycle ends
    if ((player.week - 1) % player.rewardsOrder.length === 0) {
      player.rewardsOrder = shuffle(player.rewardsOrder);
      player.rewardsAchieved = []; // reset visible list
      alert("♻️ Rewards reshuffled for a new cycle!");
    }

    savePlayer();
    showPlan();
    updateProfile();
  } else {
    alert("❌ Complete all tasks first!");
  }
}

function updateProfile() {
  // Home section
  document.getElementById("week").textContent = "Current Week: " + player.week;
  document.getElementById("points").textContent = "Weekly Points: " + player.points;

  const percent = Math.floor((player.dayProgress / player.totalTasks) * 100) || 0;
  const progressEl = document.getElementById("progress");
  progressEl.style.width = percent + "%";
  progressEl.textContent = percent + "%";

  document.getElementById("startBtn").textContent = player.startedWeek ? "Continue Week" : "Start Week";

  // ✅ Get current reward
  const rewardIndex = (player.week - 1) % player.rewardsOrder.length;
  const nextRewardName = player.rewardsOrder[rewardIndex];

  // ✅ Figure out days left until Saturday
  const now = new Date();
  let todayIndex = now.getDay(); // Sunday=0
  if (now.getHours() < 5) {
    todayIndex = todayIndex - 1;
    if (todayIndex < 0) todayIndex = 6;
  }
  const daysLeft = 6 - todayIndex;

  // ✅ Update Home section
  document.getElementById("reward").textContent = "🎁 Unlocks on Saturday";
  document.getElementById("daysLeft").textContent =
    daysLeft === 0
      ? `🎁 Today! Reward: ${nextRewardName}`
      : `${daysLeft} day(s) left until your next reward 🎁 (${nextRewardName})`;

  // Profile section
  document.getElementById("profileName").textContent = player.name;
  document.getElementById("profileGoal").textContent = player.goal;
  document.getElementById("profileWeek").textContent = player.week;
  document.getElementById("profilePoints").textContent = player.points;

  // ✅ Add reward countdown in Profile section too
if (document.getElementById("nextReward")) {
  const rewardEl = document.getElementById("nextReward");

  if (daysLeft === 0) {
    rewardEl.textContent = `🎁 Today! Reward: ${nextRewardName}`;
    rewardEl.classList.add("rewardToday");
    rewardEl.classList.remove("rewardCountdown");
  } else {
    rewardEl.textContent = `${daysLeft} day(s) left until your next reward 🎁 (${nextRewardName})`;
    rewardEl.classList.add("rewardCountdown");
    rewardEl.classList.remove("rewardToday");
  }
}


  // Rewards section
  const rewardsList = document.getElementById("rewardsList");
  rewardsList.innerHTML = player.rewardsAchieved.length
    ? player.rewardsAchieved.map(r => `<li>${r}</li>`).join("")
    : "<li>No rewards unlocked yet.</li>";
}

function resetProgress() {
  if (confirm("Are you sure you want to reset all progress?")) {
    const currentUser = localStorage.getItem("fitness30Day_current");
    if (currentUser) {
      localStorage.removeItem(`fitness30Day_${currentUser}`);
      localStorage.removeItem("fitness30Day_current");
    }
    location.reload();
  }
}

    function openNav(){ document.getElementById("sidebar").style.width="250px"; }
    function closeNav(){ document.getElementById("sidebar").style.width="0"; }
    function showSection(id){ document.querySelectorAll(".section").forEach(s=>s.classList.remove("active-section")); document.getElementById(id).classList.add("active-section"); closeNav(); }

    showPlan(); updateProfile();
    function formatDate(date) {
  return date.toLocaleDateString("en-US", { day: "numeric", month: "short", year: "numeric" });
}

function getWeekRange(date) {
  const day = date.getDay(); // 0 = Sun
  const monday = new Date(date);
  monday.setDate(date.getDate() - ((day + 6) % 7));
  const sunday = new Date(monday);
  sunday.setDate(monday.getDate() + 6);
  return { monday, sunday };
}

function renderWeeklyGoal() {
  const now = new Date();
  let days = ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];
  let todayIdx = (now.getDay() + 6) % 7; // Mon=0

  const weekHTML = `
    <div style="
      display:flex;
      flex-wrap:wrap;
      justify-content:center;
      gap:6px;
      margin-top:10px;
      max-width:100%;
    ">
      ${days.map((d,i)=>{
        const worked = Object.keys(player.completed).some(k=>{
          let [wk,dayIdx] = k.split("-").map(Number);
          return wk===player.week && dayIdx===i;
        });
        const isToday = i===todayIdx;
        return `<div style="
          padding:4px 6px;
          border-radius:6px;
          font-size:12px;
          background:${worked ? "#ffcc00" : "#444"};
          color:${isToday ? "#000" : "#eee"};
          font-weight:${isToday ? "bold" : "normal"};
          min-width:36px;
          text-align:center;
        ">${d}</div>`;
      }).join("")}
    </div>
  `;
  document.getElementById("weeklyGoal").innerHTML = weekHTML;
}

function showSignup() {
  document.getElementById("signupForm").style.display = "block";
  document.getElementById("loginForm").style.display = "none";
  document.getElementById("signupTab").style.fontWeight = "bold";
  document.getElementById("loginTab").style.fontWeight = "normal";
}

function showLogin() {
  document.getElementById("signupForm").style.display = "none";
  document.getElementById("loginForm").style.display = "block";
  document.getElementById("signupTab").style.fontWeight = "normal";
  document.getElementById("loginTab").style.fontWeight = "bold";
}

  </script>
  
</body>
</html>
